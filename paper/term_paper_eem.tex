\documentclass[12pt,a4paper]{article}
\usepackage{lmodern}

\usepackage{placeins}
\usepackage{booktabs}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Mapping=tex-text,Scale=MatchLowercase}
  \newcommand{\euro}{€}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[lmargin = 3 cm,rmargin = 2.5cm,tmargin=2.5cm,bmargin=2.5cm]{geometry}

% Figure Placement:
\usepackage{float}
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][2] {
    \expandafter\origfigure\expandafter[H]
} {
    \endorigfigure
}

%% citation setup
\usepackage{csquotes}

\usepackage[backend=biber, maxbibnames = 99, style = apa]{biblatex}
\setlength\bibitemsep{1.5\itemsep}
\addbibresource{R_packages.bib}
\bibliography{references.bib}
\usepackage{longtable,booktabs}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\ifxetex
  \usepackage[setpagesize=false, % page size defined by xetex
              unicode=false, % unicode breaks when used with xetex
              xetex]{hyperref}
\else
  \usepackage[unicode=true, linktocpage = TRUE]{hyperref}
\fi
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Nils Paffen, David Schulze},
            pdftitle={``Stay home'' and let the simulation play},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\setcounter{secnumdepth}{5}

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}
  \title{``Stay home'' and let the simulation play}
  \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
\subtitle{Predicting the Outcome Kreisliga A Reklinghausen Season 2019-2020}
  \author{Nils Paffen, David Schulze}
  \preauthor{\centering\large\emph}
  \postauthor{\par}
  \predate{\centering\large\emph}
  \postdate{\par}
  \date{today}


%% linespread settings

\usepackage{setspace}

\onehalfspacing

% Language Setup

\usepackage{ifthen}
\usepackage{iflang}
\usepackage[super]{nth}
\usepackage[ngerman, english]{babel}

%Acronyms
\usepackage[printonlyused, withpage, nohyperlinks]{acronym}
\usepackage{changepage}

% Multicols for the Title page
\usepackage{multicol}

\begin{document}

\selectlanguage{english}


%\maketitle

\begin{titlepage}
  \noindent\begin{minipage}{0.6\textwidth}
	  \IfLanguageName{english}{University of Duisburg-Essen}{Universität Duisburg-Essen}\\
	  \IfLanguageName{english}{Faculty of Business Administration and Economics}{Fakultät für Wirtschaftswissensschaften}\\
	  \IfLanguageName{english}{Chair of Economeics}{Lehrstuhl für Wirtschaftswissenschaften}\\
  \end{minipage}
	\begin{minipage}{0.4\textwidth}
	  \begin{flushright}
  	  \vspace{-0.5cm}
      \IfLanguageName{english}{\includegraphics*[width=5cm]{Includes/duelogo_en.png}}{\includegraphics*[width=5cm]{Includes/duelogo_de.png}}
	  \end{flushright}
	\end{minipage}
  \\
  \vspace{0.5cm}
  \begin{center}
  \huge{``Stay home'' and let the simulation play}\\
  \vspace{.25cm}
  \Large{Predicting the Outcome Kreisliga A Reklinghausen Season 2019-2020}\\
  \vspace{0.5cm}
  \large{Working Paper}\\
  \vspace{0.5cm}
  \large{  \IfLanguageName{english}{Submitted to the Faculty of \\ Economics  \\at the \\University of Duisburg-Essen}{Vorgelegt der \\Fakultät für Wirtschaftswissenschaften der \\ Universität Duisburg-Essen}\\}
  \vspace{0.75cm}
  \large{\IfLanguageName{english}{from:}{von:}}\\
  \vspace{0.5cm}
  Nils Paffen, David Schulze\\
  \end{center}
  %\vspace{2cm}
  \vfill
  \hrulefill

  \noindent\begin{minipage}[t]{0.3\textwidth}
  \IfLanguageName{english}{Reviewer:}{Erstgutachter:}
  \end{minipage}
  \begin{minipage}[t]{0.7\textwidth}
  \hspace{1cm}Prof.~Dr.~Christoph Hanck
  \end{minipage}

  \noindent\begin{minipage}[t]{0.3\textwidth}
  \IfLanguageName{english}{Deadline:}{Abgabefrist:}
  \end{minipage}
  \begin{minipage}[t]{0.7\textwidth}
  \hspace{1cm}
  \end{minipage}

  \hrulefill

  \begin{multicols}{3}

  Name:

  Matriculation Number:

  E-Mail:

  Study Path:

  Semester:

  Graduation (est.):
 
  \columnbreak

  David Schulze

  --
  
  david.schulze@rgs-econ.de

  --

  \nth{5}

  -- 
  
  \columnbreak

  Nils Paffen

  3071594
  
  nils.paffen@stud.uni-due.de

  M.Sc. Economics

  \nth{2}

  Winter Term 2021

	\end{multicols}

\end{titlepage}

\newgeometry{top=2cm, left = 5cm, right = 2.5cm, bottom = 2.5cm}


\pagenumbering{Roman}
{
\hypersetup{linkcolor=black}

\setcounter{tocdepth}{3}
\tableofcontents
}

\newpage
\listoffigures
\addcontentsline{toc}{section}{List of Figures}

%\newpage
\listoftables
\addcontentsline{toc}{section}{List of Tables}

\section*{List of Abbreviations}
\addcontentsline{toc}{section}{List of Abbreviations}

\begin{adjustwidth}{1.5em}{0pt}

\begin{acronym}[dummyyyy]
 \acro{LASSO}{Least Absolute Shrinkage and Selection Operator}
 \acro{pcr}{Principal Components Regression}
 \acro{RMSE}{Root Mean Squared Error}
 \acro{MAE}{Mean Absolute Error}
 \acro{SEM}{Single Electricity Market}
 \acro{I-SEM}{Integrated Single Electricity Market}
 \acro{EU}{European Union}
 \acro{DM}{Diebold-Mariano}


%Falls eine Abkürzung in der Mehrzahl nicht einfach auf "s" endet muss das speziell eingestellt werden.
% \acro{slmtA}{super lange mega tolle Abkürzung} %Einzahl
 %\acroplural{slmtA}[slmtAs]{super lange mega tolle Abkürzungen} %Mehrzahl
 \acro{dummyyyy}{dummyyy}
\end{acronym}

\end{adjustwidth}

\restoregeometry

\newpage
\pagenumbering{arabic}
\hypertarget{introduction}{%
\section{Introduction}\label{introduction}}

The Covid-19 epidemic forced sports leagues in Germany to suspend
championships that were already in full swing. For example, the
Kreisliga Herren Klasse 2 in Recklinghausen finished around 150 games,
before the rest were canceled starting from Sunday 2020-03-12, leaving
around 90 games left unplayed until the last planned day of the
tournament on Sunday 2020-05-24. Given the distinct possibility that
there won't be a chance to make up those games later, a burning question
for many players and fans is naturally: What if they would have played
those games? We attempt to use data on games already played from the
website
\href{http://www.fussball.de/spielplan/re-kl-a-2-kreis-recklinghausen-kreisliga-a-herren-saison1920-westfalen/-/staffel/027II28DS800000DVS5489B3VS3GHJJU-G\#!/section/matchplan}{fussball.de}
to answer this question, drawing on established forecasting methods from
the literature.

\hypertarget{literature}{%
\section{Literature}\label{literature}}

Some difficulties that have to be addressed in predicting outcomes of
e.g.~the FIFA World Cup, are not relevant to the Kreisliga. For example,
the league system in Germany features two rounds per season. Each club
plays each other club tiwce: Once in each round, and once on each club's
home field. This reduces the uncertainty, when compared with the mode of
the World Cup. There, in the group stage groups are determined by luck
of the draw, a process known as \enquote{seeding}. Groups then play a so
called round-robin tournament, also known as all-play-all, were every
every group member plays each other, which corresponds to the mode in
which the Kreisliga plays. The World Cup then continues with
single-elimination, or a knock-out stage, which introduces another even
more random path dependencies. This implies that the existing literature
on forecasting results in the FIFA World Cup group stage is highly
relevant for the task at hand, since the game rules are identical.

A natural starting point for forecasting match or season outcomes in
football tournaments is using the FIFA points ranking method that is
used canonically to evaluate the strength of a team and updated after
each game. For example, a recent study by Correa et
al.~\autocite*{correa} uses FIFA points to forecast the results of the
2018 FIFA Men's World Cup. This approach has however generated criticism
and other methods have been proposed and evaluated. The benchmark study
by Laseck et al.~\autocite*{lasek2013} compares established and proposed
rankings. They find that FIFA rankings used to perform slightly worse
than alternative methods, especially two versions of the Elo rating
system originally proposed by Arpad Elo for the United States Chess
Federation to rate competitive chess players. We will consider using the
FIFA points method or these two alternative candidates.

The first candidate model is published by the anonymous website
EloRatings.net \autocite*{eloratings}, and is especially adapted for the
use in ranking football teams. The second one is the FIFA Women's World
Rankings, which has been in use since 2003. It is worth noting that the
FIFA Men's World Rankings have been adapted in 2018 to also be based on
a modification of the Elo ranking.

The website FuPa.net \autocite*{fupa} also publishes detailed statistics
as well as a so called \enquote{Power-Ranking} to evaluate the
\enquote{Formkurve}, a rough measure of recent performance. Because it
is only reflective of very recent games, it is not useful for long term
forecasting. Another raw measure would be to calculate the probability
of winning by dividing team's current points (victories are 3, draws are
2) by the total of their and their opponent's points, we can call this
the \enquote{points model}.

All these models just use weighted game results or point scores. Another
approach would be to use more data, as in Berbée et
al.~\autocite*{baseball}. While this concerns baseball, the principle is
not dependent on the rules of the game, but it is based on the influence
of individuals' and team's statistics on game outcomes. This is an
application of the model proposed by Albert and Bennet
\autocite*{albert2007}. They use the fact that wins and losses appear to
be normally distributed in the long run, so chance and skill should both
play a role. Team ability is then calculated as the deviation from the
average winning probability over time. Very generally, available
statistics are then evaluated to find those that matter the most for
team performance, measured in runs per game, which would be goals in
football. Those candidate factors are then weighted by regressing them
on the team performance. The resulting index is then used to calculate a
winning probability and this used then to simulate the season outcome by
using weighted coin-flips.

While there is not as much individual player data in football on the
level of our analysis, the team average is still something that can be
calculated. Also, more information on the games, such as location at
home or away, could be candidate factors for performance. For example,
one team might benefit more from playing at home than it hurts by being
away, receiving a net benefit from location, or the other way around.
While these data are certainly interesting, we must be aware of the
danger of overfitting the model.

Finally the literature contains references to using betting markets as a
benchmark, as they perform relatively well as predictors. For the
Kreisliga however, we don't expect betting markets to be deep enough to
reach this level of accuracy. Otherwise, they would also be an
interesting reference point.

\hypertarget{data}{%
\section{Data}\label{data}}

For the simulation study we decided to use data from the amateur
football league of the Kreisliga A Kreis Recklinghausen class A1 in
Westphalia, further called Kreisliga A1, for the 2019/2020 season. 16
clubs will play against each other on a total of 30 match days in one
home and one away game each. Due to the well known Corona crisis the
association has decided to cancel all matches from 15.03.2020. After
all, 20 matchdays have already been played until this point in time
which corresponds to a database of 158 matches. As the first half of the
season had already been completed, each team had already played at least
once against each team in the table. The extraction of real data from
websites using scraping scripts can be complicated, as website operators
have an interest in protecting their data from such automated queries.
\enquote{Fussball.de} is a website of the DFB (German Football
Association) which acts as a collection point for match results and
news, especially in the amateur sector. The match results of the website
itself cannot be directly read out. They are masked ,so they are made
unreadable when viewing the HTML file and are only evaluated afterwards
using a javascript and transferred to the CSS of the site. The site also
offers a match report, which graphically represents a temporal course of
the match. This is broken down in the HTML code, in contrast to the
match results, unmasked, and shows the course of the match in text form.
With the help of regular expression operations, such as pattern
matching, the game result can be reconstructed. The data record was then
divided into completed and unplayed games. The latter amount to 89 in
this season, which were simulated with the methods of the following
chapters.

Give a short overview of the actual standing (ranking table after
matchday 20)

(David: Describe calculating the values needed for the models.)

\hypertarget{predictive-models}{%
\section{Predictive Models}\label{predictive-models}}

To predict the outcome of the cancelled games, we calculate the
candidate rankings and use them to simulate the end of the 2019/2020
season. Specifically we calculate the EloRankings.net Ranking, the FIFA
Women's Ranking, the points model and a version of the Total Team
Average incorporating additional information. We discard the classic
FIFA Men's Ranking, since it was shown to perform worse than the other
candidates and was discarded by the FIFA Men's World Rankings as well in
2018.

Our second model is based on the rating algorithm of
\hyperref{eloratings.net}{eloratings.net/about}. The anonymous site
operator formulates the rating, representative for the strength of a
team, as follows : \begin{align}
R_n = R_0 + K \times (W - W_e).
\end{align} Here R\_n is defined as the new rating and R\_o is the old
rating. The weighting factor for each match is defined by the type of
tournament in which the match takes place and also controls for friendly
matches, which is given to the lowest weight of 20. While matches in
world championships and other major international tournaments are given
weights between 40 and 60, the rest falls into the category \enquote{all
other tournaments} which are given a weighting factor of 30. Following
this example, we also set K to 30 for matches already played in the
Kreisliga A. The weighting factor K is adjusted again based on the goal
difference of the result. Thus, K is increased by \(\dfrac{K}{2}\) if
the match was won with two goals, by \(dfrac{3}{4}\times K\) if the
match was won with three goals and by
\(\dfrac{3}{4} + \dfrac{(N-3)}{8} \times K\), where N defines the goal
difference of the match if the match was won with four or more goals. W
is the result of the match. 0 for a loss, 0.5 for a draw and 1 for a
win. W\_e is the probability of winning defined by the following formula
: \begin{align}
W_e = 1/(10^{(-dr/400)}+1)
\end{align} where dr is defined as the rating difference and the home
team receives a bonus of 100 points. This bonus is considered to be a
psychological advantage resulting from the fact that the game is played
in the home stadium(see, e.g., \textcite{Pollard2008}).

Our third model uses the poisson distribution to simulate the match
result with the probability of a goal in every minute of a match. The
probability matrix where the game result is drawn from is a
\(n \times n\) matrix where each cell indicates the proability of that
specific match result. While the rows indicates the goals of the home
team, the column indicates the goals of the away team. For example the
cell of the first row and in the first column indicates the likelihood
that the both teams socre \(0\) goals. The poisson probability function
of our model can be expressed as : \begin{align}
P(x) = \dfrac{e^{-\lambda}\lambda^x}{x!}, \lambda > 0
\end{align} where the lambda represents the average number of goals
First we estimate the following model from the matches already played:
\begin{align}
goals = home + team + opponent . 
\end{align} Where goals represents the number of goals scored by a team
in a game, home presents a dummy variable that is 1 for the home team
and 0 for the away team, team representing the home team, and opponent,
team representing the opponent team.

In summary, the coefficients of the model show that the club
\enquote{Altendorf-Ulfkotte}, both as home and away club, has a strong
negative and a strong positive influence, both highly significant, on
goals, i.e.~the number of goals. Since the club is in the last place in
the current table, as mentioned in the Data section, we expected that it
would be easier to score goals if they played against the team on the
last place of the seasons soccer league table rather than the team on
the first place. On the other hand it will be harder for this last
placed team to score goals even if they are the home team.

Following Correa et al.~\autocite*{correa}, we then run the simulation
by drawing the results of each game from a binomial distribution. For
each game and team, the probability of winning is dividing the ranking
points awarded each team by their and their competitors sum of points.

Running this simulation repeatedly should indicate the distribution and
expected average of outcomes. Correa et al.~\autocite*{correa} execute
200,000 runs, but because of the relatively low complexity of the
Kreisliga's format compared to the World Cup, especially because there
are no eleminiation rounds, we expect to need less repetitions.

A few alternatives have been developed for forecasting football games.
The potential of using independent Poisson distributions to match the
empirical distribution of goals scored by a team has been improved on by
introducing correlation between the teams playing against one another in
a bivariate Poisson distribution \textcite{karlis2003}.

While the independent Poisson distributions already allowed for a better
fit and to model the outcome of draws, Boshnakov et
al.~\autocite*{boshnakov2016} used a Weibull count model to improve even
on the bivariate Poisson model, allowing them even to outperform betting
market in selected bets.

\hypertarget{results}{%
\section{Results}\label{results}}

For the simulation study using the elo rating, as explained in the
predictive models chapter,we used the average of all matches played in
the current season resulting in a tie for the probability of a draw.
Half of the percentage points are deducted from the home team's winning
probability and half from the away team's winning probability.

\begin{longtable}[]{@{}rlrr@{}}
\toprule
Rank & Club & Score & Run\tabularnewline
\midrule
\endhead
1 & VfL Ramsdorf & 64.34676 & 2581\tabularnewline
2 & TuS Gahlen & 58.74429 & 2581\tabularnewline
3 & SV Schermbeck II & 57.74274 & 2581\tabularnewline
4 & Fenerbahce I. Marl & 53.52383 & 2581\tabularnewline
5 & 1. SC BW Wulfen & 50.88454 & 2581\tabularnewline
6 & TSV Raesfeld & 50.64084 & 2581\tabularnewline
7 & TuS Velen & 41.79078 & 2581\tabularnewline
8 & SC Marl-Hamm & 40.90701 & 2581\tabularnewline
9 & BVH Dorsten & 39.89500 & 2581\tabularnewline
10 & SV Lembeck & 39.56838 & 2581\tabularnewline
11 & FC RW Dorsten & 35.82449 & 2581\tabularnewline
12 & Westfalia Gemen II & 32.40101 & 2581\tabularnewline
13 & SC Reken II & 29.11275 & 2581\tabularnewline
14 & TuS 05 Sinsen II & 23.86207 & 2581\tabularnewline
15 & Adler Weseke II & 22.59512 & 2581\tabularnewline
16 & SV Altendorf-Ulfkotte & 19.50446 & 2581\tabularnewline
\bottomrule
\end{longtable}

The simulation of the elo rating

\begin{longtable}[]{@{}rlrr@{}}
\toprule
Rank & Club & Score & Run\tabularnewline
\midrule
\endhead
1 & VfL Ramsdorf & 63.46088 & 1981\tabularnewline
2 & TuS Gahlen & 57.54770 & 1981\tabularnewline
3 & SV Schermbeck II & 56.68854 & 1981\tabularnewline
4 & Fenerbahce I. Marl & 52.45432 & 1981\tabularnewline
5 & 1. SC BW Wulfen & 49.74609 & 1981\tabularnewline
6 & TSV Raesfeld & 49.58253 & 1981\tabularnewline
7 & TuS Velen & 40.56790 & 1981\tabularnewline
8 & SC Marl-Hamm & 39.67895 & 1981\tabularnewline
9 & BVH Dorsten & 38.56991 & 1981\tabularnewline
10 & SV Lembeck & 38.49319 & 1981\tabularnewline
11 & FC RW Dorsten & 34.61080 & 1981\tabularnewline
12 & Westfalia Gemen II & 31.46037 & 1981\tabularnewline
13 & SC Reken II & 27.79455 & 1981\tabularnewline
14 & TuS 05 Sinsen II & 22.68854 & 1981\tabularnewline
15 & Adler Weseke II & 21.69107 & 1981\tabularnewline
16 & SV Altendorf-Ulfkotte & 18.52751 & 1981\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{conclusion}{%
\section{Conclusion}\label{conclusion}}

\newpage

\printbibliography



\end{document}
